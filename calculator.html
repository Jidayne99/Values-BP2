<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Trade Calculator</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

body {
    background-color: #050505;
    color: #eee;
    font-family: 'Orbitron', sans-serif;
    margin: 0;
    padding: 20px;
}
.trade-calculator {
    max-width: 800px;
    margin: 0 auto;
}
h1 {
    text-align: center;
    font-size: 2em;
    color: #0ff;
    text-shadow: 0 0 5px #0ff, 0 0 10px #0ff;
}
.side-title {
    margin-bottom: 10px;
    color: #ff8c00;
    font-size: 1.5em;
    text-shadow: 0 0 4px #ff8c00;
}
.calc-section {
    display: flex;
    flex-wrap: wrap;
}
.side {
    flex: 1;
    min-width: 260px;
    margin: 10px;
    background-color: #111;
    padding: 10px;
    border-radius: 8px;
}
.input-group {
    margin-bottom: 10px;
}
.input-group input {
    width: calc(100% - 80px);
    padding: 8px;
    font-size: 1em;
    color: #0ff;
    background-color: #222;
    border: 1px solid #0ff;
    border-radius: 4px;
}
.input-group button {
    width: 70px;
    margin-left: 5px;
    padding: 8px;
    background: linear-gradient(45deg, #00ffff, #ff8c00);
    color: #111;
    font-weight: bold;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    box-shadow: 0 0 5px #00ffff, 0 0 10px #ff8c00;
}
.input-group button:hover {
    opacity: 0.8;
}
.item-list {
    list-style: none;
    padding: 0;
    margin: 0;
}
.item-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #222;
    margin: 5px 0;
    padding: 5px 10px;
    border: 1px solid #444;
    border-radius: 4px;
}
.item-list li span {
    flex: 1;
    color: #0ff;
}
.item-list li button.remove-btn {
    background: #a00;
    color: #fff;
    border: none;
    padding: 3px 6px;
    border-radius: 3px;
    cursor: pointer;
}
.item-list li button.remove-btn:hover {
    background: #d00;
}
.results {
    margin-top: 20px;
    text-align: center;
}
.results div {
    margin: 5px 0;
}
.score-win { color: #0f0; }
.score-fair { color: #ff0; }
.score-lose { color: #f00; }

@media (max-width: 600px) {
    .calc-section { flex-direction: column; }
}
</style>
</head>
<body>
<div class="trade-calculator">
  <h1>Trade Calculator</h1>
  <div class="calc-section">
    <div class="side">
      <div class="side-title">Your Offer</div>
      <div class="input-group">
        <input type="text" id="your-input" list="itemsList" placeholder="Type item name">
        <button id="add-your">Add</button>
      </div>
      <datalist id="itemsList">
        <!-- Options populated via script -->
      </datalist>
      <ul id="your-list" class="item-list"></ul>
    </div>
    <div class="side">
      <div class="side-title">Their Offer</div>
      <div class="input-group">
        <input type="text" id="their-input" list="itemsList" placeholder="Type item name">
        <button id="add-their">Add</button>
      </div>
      <ul id="their-list" class="item-list"></ul>
    </div>
  </div>
  <div class="results">
    <div id="your-total">Your Total Value: 0, Demand: 0, Score: 0</div>
    <div id="their-total">Their Total Value: 0, Demand: 0, Score: 0</div>
    <div id="result" class="score-fair">Result: FAIR</div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // Item data: name, value, demand
    const items = [
        { name: 'Iron Sword', value: 10, demand: 50 },
        { name: 'Steel Shield', value: 20, demand: 30 },
        { name: 'Magic Potion', value: 5, demand: 80 },
        { name: 'Dragon Armor', value: 50, demand: 10 },
        { name: 'Healing Herb', value: 2, demand: 70 },
        { name: 'Mystic Wand', value: 40, demand: 20 },
        { name: 'Cursed Dagger', value: 15, demand: 40 },
        { name: 'Golden Crown', value: 100, demand: 5 },
        { name: 'Silver Ring', value: 8, demand: 60 },
        { name: 'Legendary Bow', value: 45, demand: 25 }
        // ... add all items from your value list here ...
    ];

    // Populate datalist with item names
    const dataList = document.getElementById('itemsList');
    items.forEach(item => {
        const option = document.createElement('option');
        option.value = item.name;
        dataList.appendChild(option);
    });

    const yourInput = document.getElementById('your-input');
    const theirInput = document.getElementById('their-input');
    const addYourBtn = document.getElementById('add-your');
    const addTheirBtn = document.getElementById('add-their');
    const yourListEl = document.getElementById('your-list');
    const theirListEl = document.getElementById('their-list');
    const yourTotalEl = document.getElementById('your-total');
    const theirTotalEl = document.getElementById('their-total');
    const resultEl = document.getElementById('result');

    let yourItems = [];
    let theirItems = [];

    function addItem(itemName, side) {
        const list = side === 'your' ? yourItems : theirItems;
        const listEl = side === 'your' ? yourListEl : theirListEl;
        const input = side === 'your' ? yourInput : theirInput;

        // Find item object by name (case-insensitive)
        const item = items.find(i => i.name.toLowerCase() === itemName.toLowerCase());
        if (!item) {
            alert('Item not found: ' + itemName);
            return;
        }
        // Prevent duplicate
        if (list.some(i => i.name === item.name)) {
            alert('Item already added: ' + item.name);
            return;
        }
        list.push(item);
        // Create list element
        const li = document.createElement('li');
        const span = document.createElement('span');
        span.textContent = item.name;
        const removeBtn = document.createElement('button');
        removeBtn.textContent = 'x';
        removeBtn.className = 'remove-btn';
        removeBtn.addEventListener('click', () => {
            listEl.removeChild(li);
            // Remove from array and recalc
            const idx = list.findIndex(i => i.name === item.name);
            if (idx > -1) list.splice(idx, 1);
            calculate();
        });
        li.appendChild(span);
        li.appendChild(removeBtn);
        listEl.appendChild(li);
        input.value = '';
        calculate();
    }

    addYourBtn.addEventListener('click', () => {
        const name = yourInput.value.trim();
        if (name) addItem(name, 'your');
    });
    addTheirBtn.addEventListener('click', () => {
        const name = theirInput.value.trim();
        if (name) addItem(name, 'their');
    });

    function calculate() {
        const sumValueYour = yourItems.reduce((sum, i) => sum + i.value, 0);
        const sumDemandYour = yourItems.reduce((sum, i) => sum + i.demand, 0);
        const sumValueTheir = theirItems.reduce((sum, i) => sum + i.value, 0);
        const sumDemandTheir = theirItems.reduce((sum, i) => sum + i.demand, 0);

        const scoreYour = 0.7 * sumValueYour + 0.3 * sumDemandYour;
        const scoreTheir = 0.7 * sumValueTheir + 0.3 * sumDemandTheir;

        yourTotalEl.textContent = `Your Total Value: ${sumValueYour}, Demand: ${sumDemandYour}, Score: ${scoreYour.toFixed(1)}`;
        theirTotalEl.textContent = `Their Total Value: ${sumValueTheir}, Demand: ${sumDemandTheir}, Score: ${scoreTheir.toFixed(1)}`;

        // Determine WIN/FAIR/LOSE (Â±5% threshold for fair trade)
        const diff = scoreYour - scoreTheir;
        const percentDiff = Math.abs(diff) / (Math.max(scoreYour, scoreTheir) || 1);
        if (Math.abs(diff) < 1e-6 || percentDiff < 0.05) {
            resultEl.textContent = 'Result: FAIR';
            resultEl.className = 'score-fair';
        } else if (diff > 0) {
            resultEl.textContent = 'Result: WIN';
            resultEl.className = 'score-win';
        } else {
            resultEl.textContent = 'Result: LOSE';
            resultEl.className = 'score-lose';
        }
    }
});
</script>
</body>
</html>
